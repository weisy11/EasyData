# 图像方向矫正

------


## 目录


- [1. 背景](#1)
- [2. 模型](#2)
    - [2.1 训练](#2.1)
    - [2.2 部署](#2.2)
- [3. 视觉任务表现](#3)

<a name="1"></a>
## 1. 背景

深度学习在计算机视觉领域已经取得了较大的发展，在视觉场景的诸多任务上已有广泛应用，我们针对模型部署中面临的数据质量问题，提出了PP-LDI解决方案。

深度学习为数据驱动，模型效果极大地依赖于训练数据，而通常情况下训练数据集是针对特定问题进行设计的，这样训练得到的模型通常针对预设问题具有较好效果，但是在真实的部署场景中往往存在大量的低质量数据，这些数据极大地影响了模型的预测效果，比如图像方向问题。目前大部分视觉任务数据集均预设图像方向为正，这一点在大多真实场景中无法确保，因此其他方向的数据在预测时往往得不到预期效果，如果强行将图像方向考虑到训练数据集设计中，则又会对模型预测效果带来负面影响，或是需要更大体量的模型影响推理速度，针对上述问题，PP-LDI提供了图像方向矫正模型，该模型能够对图像方向进行分类预测，同时该模型极为轻量，对系统推理速度影响较小。图像方向矫正模型的使用示例如下图所示：

<div align="center">
  <img src="https://user-images.githubusercontent.com/45199522/200239418-b7b5cf69-4fbe-4500-a36e-16d8491611e8.png"/>
</div>

<a name="2"></a>
## 2. 模型介绍

在本小节我们会介绍图像方向矫正模型从训练到部署的全部流程。

<a name="2.1"></a>
#### 2.1 训练

图像方向矫正模型本质为图像分类任务，同时考虑到模型需要足够轻量，因此我们采用了PaddleClas的PULC方案，训练详情可以参考[PULC图像方向分类](@clas_pulc)。

<a name="2.2"></a>
#### 2.2 部署

对于图像方向矫正模型的使用方法，我们提供了 EasyData whl 的方式，支持命令行直接预测以及在 Python 脚本中调用的方式，具体可以参考[图像方向矫正模型部署](@quickstart)。

<a name="3"></a>
## 3. 视觉任务表现

对于方向矫正模型对下游任务的效果改善情况，我们在图像分类、目标检测、图像检索、OCR等任务上进行了评估，具体指标如下：

<a name="3.1"></a>
### 3.1 图像分类

对于图像分类任务，我们基于 ImageNet1k 数据集进行了评测，模型使用 PPLCNet_x1_0，具体效果如下表所示：

| 是否进行方向矫正  | 原始数据 | 多方向数据 | 
| :--:           | :--:    | :--:     |
| 不使用 | 0.71318 | 0.53912  |
| 使用（阈值0）    | 0.50898 | 0.70226  |
| 使用（阈值0.80） | 0.71262 | 0.68396  |
| 使用（阈值0.90） | 0.71312 | 0.66167  |
| 使用（阈值0.95） | 0.71318 | 0.53969  |


在上表中，原始数据为 ImageNet1k 数据集，多方向数据为基于 ImageNet1k 数据进行方向扩充后的数据集，扩充方法为：对原始图像数据分别逆时针旋转0度、90度、180度、270度得到。
